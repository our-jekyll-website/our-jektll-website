---
layout: default
title: 用户列表
---

<script>
document.addEventListener('DOMContentLoaded', async function() {
    const user = JSON.parse(sessionStorage.getItem('user'));
    if (!user || user.role !== 'trader') {
        window.location.href = '/shipment-dashboard/orders.html';
        return;
    }

    // 加载用户列表
    try {
        const response = await fetch('/shipment-dashboard/data/users.json');
        const data = await response.json();
        const customers = data.users.filter(u => u.role === 'customer');
        displayUsers(customers);
    } catch (error) {
        console.error('加载用户列表失败:', error);
    }

    function displayUsers(users) {
        const usersList = document.getElementById('usersList');
        
        if (users.length === 0) {
            usersList.innerHTML = '<div class="empty-state"><p>暂无用户数据</p></div>';
            return;
        }

        const html = `
            <table class="users-table">
                <thead>
                    <tr>
                        <th>用户名</th>
                        <th>客户代码</th>
                        <th>姓名</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody>
                    ${users.map(user => `
                        <tr>
                            <td>${user.username}</td>
                            <td>${user.customerCode || '-'}</td>
                            <td>${user.name}</td>
                            <td>
                                <button onclick="viewUserOrders('${user.username}')" class="btn-view">查看订单</button>
                            </td>
                        </tr>
                    `).join('')}
                </tbody>
            </table>
        `;
        usersList.innerHTML = html;
    }

    window.viewUserOrders = function(username) {
        // 将用户名存储在 sessionStorage 中，用于订单列表页面的筛选
        sessionStorage.setItem('filterUsername', username);
        window.location.href = '/shipment-dashboard/orders.html?filter=user';
    };
});
</script>

<div class="container">
    <h1>用户列表</h1>
    <button onclick="window.location.href='/shipment-dashboard/orders.html'" class="btn-create" style="margin-right: 10px;">返回订单列表</button>
    <button onclick="logoutAndGoLogin()" class="btn-create">退出</button>
    <div id="usersList" class="users-container"></div>
</div>

<script>
function logoutAndGoLogin() {
    sessionStorage.removeItem('user');
    window.location.href = '/shipment-dashboard/login.html';
}
</script>

<style>
.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

.users-table {
    width: 100%;
    border-collapse: collapse;
    background: white;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    margin-top: 20px;
}

.users-table th,
.users-table td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid #ddd;
}

.users-table th {
    background-color: #f8f9fa;
    font-weight: bold;
}

.users-table tr:hover {
    background-color: #f5f5f5;
}

.btn-view {
    padding: 6px 12px;
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

.btn-view:hover {
    background-color: #0056b3;
}

.btn-create {
    padding: 10px 20px;
    background-color: #28a745;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
    margin-bottom: 20px;
}

.btn-create:hover {
    background-color: #218838;
}

.empty-state {
    text-align: center;
    padding: 40px;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
</style> 